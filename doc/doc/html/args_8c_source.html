<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libstephen: src/args.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">libstephen
   
   </div>
   <div id="projectbrief">Data structures and unit tests for C</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('args_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">src/args.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="args_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***************************************************************************/</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;inttypes.h&gt;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;libstephen/base.h&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;libstephen/list.h&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;libstephen/ad.h&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;libstephen/ll.h&quot;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">/*******************************************************************************</span>
<a name="l00038"></a>00038 <span class="comment"></span>
<a name="l00039"></a>00039 <span class="comment">                               Private Functions</span>
<a name="l00040"></a>00040 <span class="comment"></span>
<a name="l00041"></a>00041 <span class="comment">*******************************************************************************/</span>
<a name="l00042"></a>00042 
<a name="l00052"></a><a class="code" href="args_8c.html#a60351611852a7f785980e2ed7bb01cd9">00052</a> <span class="keywordtype">int</span> <a class="code" href="args_8c.html#a60351611852a7f785980e2ed7bb01cd9" title="Returns the index of a flag for a specific character.">flag_index</a>(<span class="keywordtype">char</span> c)
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054   <span class="keywordtype">int</span> idx;
<a name="l00055"></a>00055   <span class="keywordflow">if</span> (c &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;Z&#39;</span>) {
<a name="l00056"></a>00056     idx = 26 + (c - <span class="charliteral">&#39;A&#39;</span>);
<a name="l00057"></a>00057   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;z&#39;</span>) {
<a name="l00058"></a>00058     idx = (c - <span class="charliteral">&#39;a&#39;</span>);
<a name="l00059"></a>00059   } <span class="keywordflow">else</span> {
<a name="l00060"></a>00060     idx = -1;
<a name="l00061"></a>00061   }
<a name="l00062"></a>00062   <span class="keywordflow">return</span> idx;
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 
<a name="l00072"></a><a class="code" href="args_8c.html#ae832b257f1589197b39bb90ef4ada77d">00072</a> <span class="keywordtype">char</span> <a class="code" href="args_8c.html#ae832b257f1589197b39bb90ef4ada77d" title="Add regular flags (i.e. characters) to the smb_ad structure.">process_flag</a>(smb_ad *pData, <span class="keywordtype">char</span> *cFlags)
<a name="l00073"></a>00073 {
<a name="l00074"></a>00074   <span class="keywordtype">char</span> last;
<a name="l00075"></a>00075   <span class="keywordtype">int</span> idx;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   <span class="keywordflow">while</span> (*cFlags != <span class="charliteral">&#39;\0&#39;</span>) {
<a name="l00078"></a>00078     <span class="keywordflow">if</span> ((idx = <a class="code" href="args_8c.html#a60351611852a7f785980e2ed7bb01cd9" title="Returns the index of a flag for a specific character.">flag_index</a>(*cFlags)) != -1) {
<a name="l00079"></a>00079       last = *cFlags;
<a name="l00080"></a>00080       pData-&gt;flags |= UINT64_C(1) &lt;&lt; idx;
<a name="l00081"></a>00081     }
<a name="l00082"></a>00082     cFlags++;
<a name="l00083"></a>00083   }
<a name="l00084"></a>00084   <span class="keywordflow">return</span> last;
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00094"></a><a class="code" href="args_8c.html#a4f1f9e1264b576abe0a36e1f443b1e38">00094</a> <span class="keywordtype">char</span> *<a class="code" href="args_8c.html#a4f1f9e1264b576abe0a36e1f443b1e38" title="Add the long flag to the data structure.">process_long_flag</a>(smb_ad *pData, <span class="keywordtype">char</span> *sTitle)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096   DATA d, e;
<a name="l00097"></a>00097   d.data_ptr = sTitle + 2;
<a name="l00098"></a>00098   <a class="code" href="linkedlist_8c.html#ad0fa08647833fbfb6badf3feb4a7e734" title="Append the given data to the end of the list.">ll_append</a>(pData-&gt;long_flags, d); <span class="comment">// Add the portion AFTER the &quot;--&quot;</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   e.data_ptr = NULL;
<a name="l00101"></a>00101   <a class="code" href="linkedlist_8c.html#ad0fa08647833fbfb6badf3feb4a7e734" title="Append the given data to the end of the list.">ll_append</a>(pData-&gt;long_flag_strings, e);
<a name="l00102"></a>00102   <span class="keywordflow">return</span> sTitle + 2;
<a name="l00103"></a>00103 }
<a name="l00104"></a>00104 
<a name="l00117"></a><a class="code" href="args_8c.html#ad75f2f503887f4fc6aa1ede1789f2a84">00117</a> <span class="keywordtype">void</span> <a class="code" href="args_8c.html#ad75f2f503887f4fc6aa1ede1789f2a84" title="Add the bare string to the data structure.">process_bare_string</a>(smb_ad *pData, <span class="keywordtype">char</span> *sStr, <span class="keywordtype">char</span> *previous_long_flag,
<a name="l00118"></a>00118                          <span class="keywordtype">int</span> previous_flag)
<a name="l00119"></a>00119 {
<a name="l00120"></a>00120   <span class="keywordflow">if</span> (previous_long_flag) {
<a name="l00121"></a>00121     DATA d;
<a name="l00122"></a>00122     d.data_ptr = sStr;
<a name="l00123"></a>00123     smb_status status;
<a name="l00124"></a>00124     <a class="code" href="linkedlist_8c.html#ad45a9374335d4b3bf517e1ea02878e87" title="Sets an existing element to a new value.">ll_set</a>(pData-&gt;long_flag_strings, <a class="code" href="linkedlist_8c.html#a14effb264a1e7bbb3c0d4674b5ce6fee" title="Returns the length of the given list.">ll_length</a>(pData-&gt;long_flag_strings) - 1, d,
<a name="l00125"></a>00125            &amp;status);
<a name="l00126"></a>00126     assert(status == SMB_SUCCESS);
<a name="l00127"></a>00127   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (previous_flag != EOF) {
<a name="l00128"></a>00128     <span class="keywordtype">int</span> idx = <a class="code" href="args_8c.html#a60351611852a7f785980e2ed7bb01cd9" title="Returns the index of a flag for a specific character.">flag_index</a>(previous_flag);
<a name="l00129"></a>00129     <span class="comment">// The flag index would be negative if the previous flag was not a</span>
<a name="l00130"></a>00130     <span class="comment">// letter.  We&#39;ll accept the segfault as an error.</span>
<a name="l00131"></a>00131     pData-&gt;flag_strings[idx] = sStr;
<a name="l00132"></a>00132   } <span class="keywordflow">else</span> {
<a name="l00133"></a>00133     DATA d;
<a name="l00134"></a>00134     d.data_ptr = sStr;
<a name="l00135"></a>00135     <a class="code" href="linkedlist_8c.html#ad0fa08647833fbfb6badf3feb4a7e734" title="Append the given data to the end of the list.">ll_append</a>(pData-&gt;bare_strings, d);
<a name="l00136"></a>00136   }
<a name="l00137"></a>00137 }
<a name="l00138"></a>00138 
<a name="l00147"></a><a class="code" href="args_8c.html#a8d0e8093797d70c2d875e7b3e3a74ee4">00147</a> <span class="keywordtype">int</span> <a class="code" href="args_8c.html#a8d0e8093797d70c2d875e7b3e3a74ee4" title="Find the string in the list and return its index, or -1.">find_string</a>(smb_ll *toSearch, <span class="keywordtype">char</span> *toFind)
<a name="l00148"></a>00148 {
<a name="l00149"></a>00149   DATA d;
<a name="l00150"></a>00150   <span class="keywordtype">char</span> *sCurr;
<a name="l00151"></a>00151   smb_iter iter = <a class="code" href="linkedlist_8c.html#aa0087aed3ec014f4bafd124e2020207e" title="Get an iterator for the linked list.">ll_get_iter</a>(toSearch);
<a name="l00152"></a>00152   <span class="keywordtype">int</span> retVal = -1;
<a name="l00153"></a>00153   smb_status status;
<a name="l00154"></a>00154   <span class="keywordflow">while</span> (iter.has_next(&amp;iter)) {
<a name="l00155"></a>00155     d = iter.next(&amp;iter, &amp;status);
<a name="l00156"></a>00156     <span class="comment">// We are using &#39;has_next&#39; to check first!</span>
<a name="l00157"></a>00157     assert(status == SMB_SUCCESS);
<a name="l00158"></a>00158     sCurr = (<span class="keywordtype">char</span> *)d.data_ptr;
<a name="l00159"></a>00159     if (strcmp(toFind, sCurr) == 0) {
<a name="l00160"></a>00160       retVal = iter.index-1; <span class="comment">// previous index</span>
<a name="l00161"></a>00161       <span class="keywordflow">break</span>;
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163   }
<a name="l00164"></a>00164   iter.destroy(&amp;iter);
<a name="l00165"></a>00165   <span class="keywordflow">return</span> retVal;
<a name="l00166"></a>00166 }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="comment">/*******************************************************************************</span>
<a name="l00169"></a>00169 <span class="comment"></span>
<a name="l00170"></a>00170 <span class="comment">                                Public Functions</span>
<a name="l00171"></a>00171 <span class="comment"></span>
<a name="l00172"></a>00172 <span class="comment">*******************************************************************************/</span>
<a name="l00173"></a>00173 
<a name="l00180"></a><a class="code" href="args_8c.html#a51481abab2eeb0cdbbbaebee43354c88">00180</a> <span class="keywordtype">void</span> <a class="code" href="args_8c.html#a51481abab2eeb0cdbbbaebee43354c88" title="Initialize an smb_ad structure in memory that has already been allocated.">arg_data_init</a>(smb_ad *data)
<a name="l00181"></a>00181 {
<a name="l00182"></a>00182   data-&gt;flags = 0;
<a name="l00183"></a>00183   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; MAX_FLAGS; i++) {
<a name="l00184"></a>00184     data-&gt;flag_strings[i] = NULL;
<a name="l00185"></a>00185   }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187   data-&gt;long_flags = <a class="code" href="linkedlist_8c.html#aa37deaadccf1c785bcad4b904a33095f" title="Allocates and initializes a new, empty linked list.">ll_create</a>();
<a name="l00188"></a>00188   data-&gt;long_flag_strings = <a class="code" href="linkedlist_8c.html#aa37deaadccf1c785bcad4b904a33095f" title="Allocates and initializes a new, empty linked list.">ll_create</a>();
<a name="l00189"></a>00189   data-&gt;bare_strings = <a class="code" href="linkedlist_8c.html#aa37deaadccf1c785bcad4b904a33095f" title="Allocates and initializes a new, empty linked list.">ll_create</a>();
<a name="l00190"></a>00190   <span class="keywordflow">return</span>;
<a name="l00191"></a>00191 }
<a name="l00192"></a>00192 
<a name="l00197"></a><a class="code" href="args_8c.html#aa224636d3915622613b93f027e84c58f">00197</a> smb_ad *<a class="code" href="args_8c.html#aa224636d3915622613b93f027e84c58f" title="Allocate and initialize a smb_ad structure for argument parsing.">arg_data_create</a>()
<a name="l00198"></a>00198 {
<a name="l00199"></a>00199   smb_ad *data = smb_new(smb_ad, 1);
<a name="l00200"></a>00200   <a class="code" href="args_8c.html#a51481abab2eeb0cdbbbaebee43354c88" title="Initialize an smb_ad structure in memory that has already been allocated.">arg_data_init</a>(data);
<a name="l00201"></a>00201   <span class="keywordflow">return</span> data;
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00209"></a><a class="code" href="args_8c.html#a681e0d3266aed3f011b43bc0502d742c">00209</a> <span class="keywordtype">void</span> <a class="code" href="args_8c.html#a681e0d3266aed3f011b43bc0502d742c" title="Free the resources of an arg_data object, but do not free it.">arg_data_destroy</a>(smb_ad * data)
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211   <a class="code" href="linkedlist_8c.html#ab8e3ccadda5dd1dc4dbf66984ef176f4" title="Frees the resources held by the linked list, and the memory allocated to the smb_ll object...">ll_delete</a>(data-&gt;long_flags);
<a name="l00212"></a>00212   <a class="code" href="linkedlist_8c.html#ab8e3ccadda5dd1dc4dbf66984ef176f4" title="Frees the resources held by the linked list, and the memory allocated to the smb_ll object...">ll_delete</a>(data-&gt;bare_strings);
<a name="l00213"></a>00213   <a class="code" href="linkedlist_8c.html#ab8e3ccadda5dd1dc4dbf66984ef176f4" title="Frees the resources held by the linked list, and the memory allocated to the smb_ll object...">ll_delete</a>(data-&gt;long_flag_strings);
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00222"></a><a class="code" href="args_8c.html#a4d4f97c2fd352e5a252d3e920c661573">00222</a> <span class="keywordtype">void</span> <a class="code" href="args_8c.html#a4d4f97c2fd352e5a252d3e920c661573" title="Free the resources of an arg data object, and then free the object itself.">arg_data_delete</a>(smb_ad *data)
<a name="l00223"></a>00223 {
<a name="l00224"></a>00224   <a class="code" href="args_8c.html#a681e0d3266aed3f011b43bc0502d742c" title="Free the resources of an arg_data object, but do not free it.">arg_data_destroy</a>(data);
<a name="l00225"></a>00225   smb_free(data);
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00239"></a><a class="code" href="args_8c.html#af41f795755de6840b9d7e4b0a23f7655">00239</a> <span class="keywordtype">void</span> <a class="code" href="args_8c.html#af41f795755de6840b9d7e4b0a23f7655" title="Analyze the argument data passed to the program.">process_args</a>(smb_ad *data, <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
<a name="l00240"></a>00240 {
<a name="l00241"></a>00241   <span class="keywordtype">char</span> *previous_long_flag = NULL;
<a name="l00242"></a>00242   <span class="keywordtype">int</span> previous_flag = EOF;
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="keywordflow">while</span> (argc--) {
<a name="l00245"></a>00245     <span class="comment">// At the beginning of the loop, argc refers to number of remaining args,</span>
<a name="l00246"></a>00246     <span class="comment">// and argv points at the pointer to the current arg.</span>
<a name="l00247"></a>00247     <span class="keywordflow">switch</span> (**argv) {
<a name="l00248"></a>00248     <span class="keywordflow">case</span> <span class="charliteral">&#39;-&#39;</span>:
<a name="l00249"></a>00249       <span class="comment">// Processing new flag type, so set previous variables to invalid.</span>
<a name="l00250"></a>00250       previous_long_flag = NULL;
<a name="l00251"></a>00251       previous_flag = EOF;
<a name="l00252"></a>00252       <span class="keywordflow">switch</span> (*(*argv + 1)) {
<a name="l00253"></a>00253       <span class="keywordflow">case</span> <span class="charliteral">&#39;-&#39;</span>:
<a name="l00254"></a>00254         <span class="comment">// Long flag</span>
<a name="l00255"></a>00255         previous_long_flag = <a class="code" href="args_8c.html#a4f1f9e1264b576abe0a36e1f443b1e38" title="Add the long flag to the data structure.">process_long_flag</a>(data, *argv);
<a name="l00256"></a>00256         previous_flag = EOF;
<a name="l00257"></a>00257         <span class="keywordflow">break</span>;
<a name="l00258"></a>00258       <span class="keywordflow">case</span> <span class="charliteral">&#39;\0&#39;</span>:
<a name="l00259"></a>00259         <span class="comment">// A single &#39;-&#39;...counts as a bare string in my book</span>
<a name="l00260"></a>00260         <a class="code" href="args_8c.html#ad75f2f503887f4fc6aa1ede1789f2a84" title="Add the bare string to the data structure.">process_bare_string</a>(data, *argv, previous_long_flag, previous_flag);
<a name="l00261"></a>00261 
<a name="l00262"></a>00262         previous_long_flag = NULL;
<a name="l00263"></a>00263         previous_flag = EOF;
<a name="l00264"></a>00264         <span class="keywordflow">break</span>;
<a name="l00265"></a>00265       <span class="keywordflow">default</span>:
<a name="l00266"></a>00266         <span class="comment">// The input is a short flag</span>
<a name="l00267"></a>00267         previous_flag = <a class="code" href="args_8c.html#ae832b257f1589197b39bb90ef4ada77d" title="Add regular flags (i.e. characters) to the smb_ad structure.">process_flag</a>(data, *argv);
<a name="l00268"></a>00268         previous_long_flag = NULL;
<a name="l00269"></a>00269         <span class="keywordflow">break</span>;
<a name="l00270"></a>00270       }
<a name="l00271"></a>00271       <span class="keywordflow">break</span>;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273     <span class="keywordflow">default</span>:
<a name="l00274"></a>00274       <span class="comment">// This is a raw string.  We first need to check if it belongs to a flag.</span>
<a name="l00275"></a>00275       <a class="code" href="args_8c.html#ad75f2f503887f4fc6aa1ede1789f2a84" title="Add the bare string to the data structure.">process_bare_string</a>(data, *argv, previous_long_flag, previous_flag);
<a name="l00276"></a>00276       previous_long_flag = NULL;
<a name="l00277"></a>00277       previous_flag = EOF;
<a name="l00278"></a>00278       <span class="keywordflow">break</span>;
<a name="l00279"></a>00279     }
<a name="l00280"></a>00280 
<a name="l00281"></a>00281     argv++;
<a name="l00282"></a>00282   }
<a name="l00283"></a>00283 }
<a name="l00284"></a>00284 
<a name="l00293"></a><a class="code" href="args_8c.html#a9b30d1af9df7206168e1216099cd13d6">00293</a> <span class="keywordtype">int</span> <a class="code" href="args_8c.html#a9b30d1af9df7206168e1216099cd13d6" title="Check whether a flag is raised.">check_flag</a>(smb_ad *pData, <span class="keywordtype">char</span> flag)
<a name="l00294"></a>00294 {
<a name="l00295"></a>00295   uint64_t idx;
<a name="l00296"></a>00296   idx = <a class="code" href="args_8c.html#a60351611852a7f785980e2ed7bb01cd9" title="Returns the index of a flag for a specific character.">flag_index</a>(flag);
<a name="l00297"></a>00297   <span class="keywordflow">if</span> (idx != -1) {
<a name="l00298"></a>00298     idx =  pData-&gt;flags &amp; (UINT64_C(1) &lt;&lt; idx);
<a name="l00299"></a>00299     <span class="keywordflow">if</span> (idx) <span class="keywordflow">return</span> 1;
<a name="l00300"></a>00300   }
<a name="l00301"></a>00301   <span class="keywordflow">return</span> 0;
<a name="l00302"></a>00302 }
<a name="l00303"></a>00303 
<a name="l00312"></a><a class="code" href="args_8c.html#a61dc32c3f9db3a2c821d06687a388567">00312</a> <span class="keywordtype">int</span> <a class="code" href="args_8c.html#a61dc32c3f9db3a2c821d06687a388567" title="Check whether a long flag appeared. It must occur verbatim.">check_long_flag</a>(smb_ad *data, <span class="keywordtype">char</span> *flag)
<a name="l00313"></a>00313 {
<a name="l00314"></a>00314   <span class="keywordflow">return</span> <a class="code" href="args_8c.html#a8d0e8093797d70c2d875e7b3e3a74ee4" title="Find the string in the list and return its index, or -1.">find_string</a>(data-&gt;long_flags, flag) + 1;
<a name="l00315"></a>00315 }
<a name="l00316"></a>00316 
<a name="l00325"></a><a class="code" href="args_8c.html#af0f74c830c61ea741f73ebb52b698275">00325</a> <span class="keywordtype">int</span> <a class="code" href="args_8c.html#af0f74c830c61ea741f73ebb52b698275" title="Check whether a bare string appeared. It must occur verbatim.">check_bare_string</a>(smb_ad *data, <span class="keywordtype">char</span> *<span class="keywordtype">string</span>)
<a name="l00326"></a>00326 {
<a name="l00327"></a>00327   <span class="keywordflow">return</span> <a class="code" href="args_8c.html#a8d0e8093797d70c2d875e7b3e3a74ee4" title="Find the string in the list and return its index, or -1.">find_string</a>(data-&gt;bare_strings, <span class="keywordtype">string</span>) + 1;
<a name="l00328"></a>00328 }
<a name="l00329"></a>00329 
<a name="l00337"></a><a class="code" href="args_8c.html#a678e35b71964e37d356d141589215e07">00337</a> <span class="keywordtype">char</span> *<a class="code" href="args_8c.html#a678e35b71964e37d356d141589215e07" title="Return the string parameter associated with the flag.">get_flag_parameter</a>(smb_ad *data, <span class="keywordtype">char</span> flag)
<a name="l00338"></a>00338 {
<a name="l00339"></a>00339   <span class="keywordtype">int</span> index = <a class="code" href="args_8c.html#a60351611852a7f785980e2ed7bb01cd9" title="Returns the index of a flag for a specific character.">flag_index</a>(flag);
<a name="l00340"></a>00340   <span class="keywordflow">if</span> (index == -1)
<a name="l00341"></a>00341     <span class="keywordflow">return</span> NULL;
<a name="l00342"></a>00342   <span class="keywordflow">else</span>
<a name="l00343"></a>00343     <span class="keywordflow">return</span> data-&gt;flag_strings[index];
<a name="l00344"></a>00344 }
<a name="l00345"></a>00345 
<a name="l00354"></a><a class="code" href="args_8c.html#a5ceaa31d0075027166d030202059821f">00354</a> <span class="keywordtype">char</span> *<a class="code" href="args_8c.html#a5ceaa31d0075027166d030202059821f" title="Return the string parameter associated with the long string.">get_long_flag_parameter</a>(smb_ad *data, <span class="keywordtype">char</span> *<span class="keywordtype">string</span>)
<a name="l00355"></a>00355 {
<a name="l00356"></a>00356   <span class="keywordtype">int</span> index = <a class="code" href="args_8c.html#a8d0e8093797d70c2d875e7b3e3a74ee4" title="Find the string in the list and return its index, or -1.">find_string</a>(data-&gt;long_flags, <span class="keywordtype">string</span>);
<a name="l00357"></a>00357   <span class="keywordflow">if</span> (index == -1)
<a name="l00358"></a>00358     <span class="keywordflow">return</span> NULL;
<a name="l00359"></a>00359   <span class="keywordflow">else</span> {
<a name="l00360"></a>00360     DATA d;
<a name="l00361"></a>00361     smb_status status;
<a name="l00362"></a>00362     d = <a class="code" href="linkedlist_8c.html#aeb6a7c2857e0c5244e46c70c4cc937af" title="Gets the data from the given index.">ll_get</a>(data-&gt;long_flag_strings, index, &amp;status);
<a name="l00363"></a>00363     assert(status == SMB_SUCCESS);
<a name="l00364"></a>00364     <span class="keywordflow">return</span> (<span class="keywordtype">char</span>*)d.data_ptr;
<a name="l00365"></a>00365   }
<a name="l00366"></a>00366 }
<a name="l00367"></a>00367 
<a name="l00373"></a><a class="code" href="args_8c.html#a6442d00676cae10e9d3fac9758490112">00373</a> <span class="keywordtype">void</span> <a class="code" href="args_8c.html#a6442d00676cae10e9d3fac9758490112" title="Print the contents of the arg data struct to a file for debugging.">ad_print</a>(smb_ad *data, FILE *f)
<a name="l00374"></a>00374 {
<a name="l00375"></a>00375   fprintf(f, <span class="stringliteral">&quot;Arg Data:\n&quot;</span>);
<a name="l00376"></a>00376   fprintf(f, <span class="stringliteral">&quot;Flags: 0x%lX\n&quot;</span>, data-&gt;flags);
<a name="l00377"></a>00377   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; MAX_FLAGS; i++) {
<a name="l00378"></a>00378     <span class="keywordflow">if</span> (data-&gt;flag_strings[i] != NULL) {
<a name="l00379"></a>00379       fprintf(f, <span class="stringliteral">&quot;%d: \&quot;%s\&quot;\n&quot;</span>, i, data-&gt;flag_strings[i]);
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381   }
<a name="l00382"></a>00382   fprintf(f, <span class="stringliteral">&quot;Long Flags: &quot;</span>);
<a name="l00383"></a>00383   <a class="code" href="iter_8c.html#a56b0eb5936e9f6acde1155b67f358c97" title="Prints anything with an iterator.">iter_print</a>(<a class="code" href="linkedlist_8c.html#aa0087aed3ec014f4bafd124e2020207e" title="Get an iterator for the linked list.">ll_get_iter</a>(data-&gt;long_flags), f, &amp;<a class="code" href="util_8c.html#a8476cd51fa728489728f95077f2a19e5" title="Print a DATA, treating it as a `char *`.">data_printer_string</a>);
<a name="l00384"></a>00384 
<a name="l00385"></a>00385   fprintf(f, <span class="stringliteral">&quot;Long Flag Strings: &quot;</span>);
<a name="l00386"></a>00386   <a class="code" href="iter_8c.html#a56b0eb5936e9f6acde1155b67f358c97" title="Prints anything with an iterator.">iter_print</a>(<a class="code" href="linkedlist_8c.html#aa0087aed3ec014f4bafd124e2020207e" title="Get an iterator for the linked list.">ll_get_iter</a>(data-&gt;long_flag_strings), f, &amp;<a class="code" href="util_8c.html#a8476cd51fa728489728f95077f2a19e5" title="Print a DATA, treating it as a `char *`.">data_printer_string</a>);
<a name="l00387"></a>00387 
<a name="l00388"></a>00388   fprintf(f, <span class="stringliteral">&quot;Bare Strings: &quot;</span>);
<a name="l00389"></a>00389   <a class="code" href="iter_8c.html#a56b0eb5936e9f6acde1155b67f358c97" title="Prints anything with an iterator.">iter_print</a>(<a class="code" href="linkedlist_8c.html#aa0087aed3ec014f4bafd124e2020207e" title="Get an iterator for the linked list.">ll_get_iter</a>(data-&gt;bare_strings), f, &amp;<a class="code" href="util_8c.html#a8476cd51fa728489728f95077f2a19e5" title="Print a DATA, treating it as a `char *`.">data_printer_string</a>);
<a name="l00390"></a>00390 }
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="args_8c.html">args.c</a>      </li>

    <li class="footer">Generated on Fri Apr 10 2015 16:52:41 for libstephen by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
