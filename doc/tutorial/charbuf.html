

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Character Buffer &mdash; libstephen 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="libstephen 0.1 documentation" href="../index.html"/>
        <link rel="up" title="Libstephen Tutorial" href="index.html"/>
        <link rel="next" title="Argument Parsing" href="args.html"/>
        <link rel="prev" title="Hash Table" href="hashtable.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> libstephen
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Libstephen Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="errors.html">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="arraylist.html">Array List (smb_al)</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkedlist.html">Linked List</a></li>
<li class="toctree-l2"><a class="reference internal" href="list.html">List Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="iterator.html">Iterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="hashtable.html">Hash Table</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Character Buffer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wide-character-version">Wide Character Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="#i-o-utilities">I/O Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="args.html">Argument Parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="unittest.html">Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="regex.html">Regular Expressions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Libstephen API Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">libstephen</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Libstephen Tutorial</a> &raquo;</li>
      
    <li>Character Buffer</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorial/charbuf.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="character-buffer">
<h1>Character Buffer<a class="headerlink" href="#character-buffer" title="Permalink to this headline">¶</a></h1>
<div class="code C highlight-c"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;libstephen/cb.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
<ul class="simple">
<li><a class="reference external" href="https://github.com/brenns10/libstephen/blob/master/inc/libstephen/cb.h">Header
(master)</a></li>
<li><a class="reference external" href="https://github.com/brenns10/libstephen/blob/master/src/charbuf.c">Implementation
(master)</a></li>
</ul>
<p>Unlike pretty much every other language under the sun, C has
exceptionally few string handling functions available to you. What&#8217;s
worse, every other language typically hides a whole lot of complexity in
its string type. Most lanugages have immutable strings, which means you
can&#8217;t modify them without reallocating them. While this has plenty of
advantages, it&#8217;s also terribly inefficient when you&#8217;re doing text
processing. Languages with immutable strings frequently provide a string
&#8220;buffer&#8221; or &#8220;builder&#8221; abstraction, which is essentially a mutable string
that has support for lots of modification actions.</p>
<p>Since C doesn&#8217;t have immutable strings, you need to implement a lot of
the &#8220;complexity&#8221; that other languages provide for efficient operations
on strings. This character buffer abstraction exists to remove some of
the common complexity with dealing with strings in C. Namely, it does
the allocation and dynamic reallocation that you would normally have to
tackle when you&#8217;re dealing with buffers - especially when reading input!</p>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>Here is the struct definition and list of functions:</p>
<div class="code C highlight-c"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">capacity</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">length</span><span class="p">;</span>
<span class="p">}</span> <span class="n">cbuf</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">cb_init</span><span class="p">(</span><span class="n">cbuf</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="kt">int</span> <span class="n">capacity</span><span class="p">);</span>
<span class="n">cbuf</span> <span class="o">*</span><span class="nf">cb_create</span><span class="p">(</span><span class="kt">int</span> <span class="n">capacity</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cb_destroy</span><span class="p">(</span><span class="n">cbuf</span> <span class="o">*</span><span class="n">obj</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cb_delete</span><span class="p">(</span><span class="n">cbuf</span> <span class="o">*</span><span class="n">obj</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">cb_concat</span><span class="p">(</span><span class="n">cbuf</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cb_append</span><span class="p">(</span><span class="n">cbuf</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="kt">char</span> <span class="n">next</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cb_trim</span><span class="p">(</span><span class="n">cbuf</span> <span class="o">*</span><span class="n">obj</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cb_clear</span><span class="p">(</span><span class="n">cbuf</span> <span class="o">*</span><span class="n">obj</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cb_printf</span><span class="p">(</span><span class="n">cbuf</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">,</span> <span class="p">...);</span>
<span class="kt">void</span> <span class="nf">cb_vprintf</span><span class="p">(</span><span class="n">cbuf</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">,</span> <span class="kt">va_list</span> <span class="n">va</span><span class="p">);</span>
</pre></div>
</div>
<p>The lifetime functions are self-explanatory, but here&#8217;s a little
commentary anyway. You really shouldn&#8217;t have to use <code class="docutils literal"><span class="pre">cb_create()</span></code> that
often. For the most part, you&#8217;ll want to declare a <code class="docutils literal"><span class="pre">cbuf</span></code> on the stack
and use <code class="docutils literal"><span class="pre">cb_init()</span></code>. This is because most use cases for a <code class="docutils literal"><span class="pre">cbuf</span></code>
involve building a string over the course of a single function call. I
don&#8217;t recommend passing around <code class="docutils literal"><span class="pre">cbuf</span></code>s, treating them as strings.</p>
<p>Also, note that calling <code class="docutils literal"><span class="pre">cb_destroy()</span></code> is <strong>optional</strong>! Generally,
you&#8217;ll want to keep the created string longer than you&#8217;ll want to keep
the <code class="docutils literal"><span class="pre">cbuf</span></code> around. The buffer is accessible through the <code class="docutils literal"><span class="pre">buf</span></code> field
of the struct. Whenever you&#8217;d like, you can stop using the <code class="docutils literal"><span class="pre">cbuf</span></code> and
start passing around the underlying buffer like a normal string.</p>
<p>Anyway:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">concat</span></code> - add a string to the end.</li>
<li><code class="docutils literal"><span class="pre">append</span></code> - add a character to the end.</li>
<li><code class="docutils literal"><span class="pre">trim</span></code> - reallocate to just the length of the string. Useful once
you&#8217;ve created the string and you want to stop using the <code class="docutils literal"><span class="pre">cbuf</span></code>.</li>
<li><code class="docutils literal"><span class="pre">clear</span></code> - clear out the whole buffer. This does nothing accept
reset <code class="docutils literal"><span class="pre">buf[0]</span></code> to <code class="docutils literal"><span class="pre">\0</span></code> and reset <code class="docutils literal"><span class="pre">length</span></code> to <code class="docutils literal"><span class="pre">0</span></code>. It doesn&#8217;t
actually &#8220;erase&#8221; the buffer.</li>
<li><code class="docutils literal"><span class="pre">printf</span></code> - print a format string onto the buffer. <code class="docutils literal"><span class="pre">vprintf</span></code> does
the same, but takes a <code class="docutils literal"><span class="pre">va_list</span></code>.</li>
</ul>
</div>
<div class="section" id="wide-character-version">
<h2>Wide Character Version<a class="headerlink" href="#wide-character-version" title="Permalink to this headline">¶</a></h2>
<p>In case you&#8217;re unfamiliar, C has a <code class="docutils literal"><span class="pre">wchar_t</span></code> type, which is capable of
holding any Unicode character. Some text processing tasks may require
you to work with the underlying characters/code points rather than the
text in some encoding. I have implemented the exact same interface, but
for <code class="docutils literal"><span class="pre">wchar_t</span> <span class="pre">*</span></code> buffers. Everything is the same, except that the type
is <code class="docutils literal"><span class="pre">wcbuf</span></code>, the functions are prefixed by <code class="docutils literal"><span class="pre">wcb_</span></code>, and the text
arguments are always <code class="docutils literal"><span class="pre">wchar_t</span> <span class="pre">*</span></code> instead of <code class="docutils literal"><span class="pre">char</span> <span class="pre">*</span></code>.</p>
</div>
<div class="section" id="i-o-utilities">
<h2>I/O Utilities<a class="headerlink" href="#i-o-utilities" title="Permalink to this headline">¶</a></h2>
<div class="code C highlight-c"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;libstephen/str.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
<ul class="simple">
<li><a class="reference external" href="https://github.com/brenns10/libstephen/blob/master/inc/libstephen/str.h">Header
(master)</a></li>
<li><a class="reference external" href="https://github.com/brenns10/libstephen/blob/master/src/string.c">Implementation
(master)</a></li>
</ul>
<p>Using the character buffer, I&#8217;ve implemented a few simple tasks quite
easily. Here are some functions you might find useful:</p>
<div class="code C highlight-c"><div class="highlight"><pre><span></span><span class="kt">char</span> <span class="o">*</span><span class="nf">read_file</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">f</span><span class="p">);</span>
<span class="kt">wchar_t</span> <span class="o">*</span><span class="nf">read_filew</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">f</span><span class="p">);</span>
<span class="kt">char</span> <span class="o">*</span><span class="nf">read_line</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">file</span><span class="p">);</span>
<span class="kt">wchar_t</span> <span class="o">*</span><span class="nf">read_linew</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">file</span><span class="p">);</span>
<span class="n">smb_ll</span> <span class="o">*</span><span class="nf">split_lines</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">source</span><span class="p">);</span>
<span class="n">smb_ll</span> <span class="o">*</span><span class="nf">split_linesw</span><span class="p">(</span><span class="kt">wchar_t</span> <span class="o">*</span><span class="n">source</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">split_lines</span></code> isn&#8217;t actually implemented with a <code class="docutils literal"><span class="pre">cbuf</span></code> (you don&#8217;t
need one), but I&#8217;m including it because I don&#8217;t have an official &#8220;String
Handling&#8221; page yet.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="args.html" class="btn btn-neutral float-right" title="Argument Parsing" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hashtable.html" class="btn btn-neutral" title="Hash Table" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2016, Stephen Brennan.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>